<!DOCTYPE html>
<html>
	<head>
		<style>
			.square {border: 1px solid black; display: inline-block;
				 padding: 5px; vertical-align: top; margin: 5px;
				 height: 120px; width: 100px; text-align: center;
				 font-size: 60px;}

			.square:hover {background-color: pink;}
            #board {width:420px}

			#winner, #start, #turn, #result {border: 2px solid black;
                 padding-top: 10px; padding-left: 10px; margin-top: 20px;
				 height: 50px; width: 200px; font-size: 18px;}
		</style>
	</head>
	<body>
		<h2>Tic Tac Toe</h2>
        <div id="start">Start Game</div>
        <div id="turn"></div>
        <div id="board">
		<script>
			const NUM_SQUARES = 9;
				for (i=0; i<NUM_SQUARES; i++) {
					id = "sq"+i;
					document.write("<div class='square' id='" + id + "'></div>" );		
				}
            let fpatt = ['X', 'O', 'X','O', 'X', 'O','X', 'O', 'X'];
            let spatt = ['O', 'X', 'O','X', 'O', 'X','O', 'X', 'O'];
            let myTurn = ['X', 'O'];
            let divs = ['sq0', 'sq1', 'sq2', 'sq3', 'sq4', 'sq5', 'sq6', 'sq7', 'sq8'];
            let of8strings = ['XOO', 'XX-', 'O--', "XXO", "XXX", "OOO", "---", "X--"];

            window.onload=function() {
                let turn = myTurn[Math.floor(Math.random()*myTurn.length)];
                if (turn === 'X') {
                    loop1:
                    for (let j = 0; j < 9; j++) {
                        sq_click = document.getElementById("sq" +j);
                        sq_click.addEventListener("click", function(){
                            result = document.getElementById("result");
                            turn = document.getElementById("turn");
						    theID = this.id;
						    number = theID.substring(2); 
						    result.innerHTML = "There is now a mark in square " + number;
                            let mark = fpatt[j];
                            turn.innerHTML = "It is " + mark + " turn";
                            this.innerHTML = mark;
                            contents= divs.map(id=>document.getElementById(id).innerHTML);
                            
                            if ((contents[0] === 'X' && contents[1] === 'X' && contents[2] === 'X') || (contents[3] === 'X' && contents[4] === 'X' && contents[5] === 'X') || (contents[6] === 'X' && contents[7] === 'X' && contents[8] === 'X')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is X";
                                return;
                            }
                            else if((contents[0] === 'X' && contents[3] === 'X' && contents[6] === 'X') || (contents[1] === 'X' && contents[4] === 'X' && contents[7] === 'X') || (contents[2] === 'X' && contents[5] === 'X' && contents[8] === 'X')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is X";
                                return;
                            }
                            else if((contents[2] === 'X' && contents[4] === 'X' && contents[6] === 'X') || (contents[0] === 'X' && contents[4] === 'X' && contents[8] === 'X')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is X";
                                return;
                            }
                            else if ((contents[0] === 'O' && contents[1] === 'O' && contents[2] === 'O') || (contents[3] === 'O' && contents[4] === 'O' && contents[5] === 'O') || (contents[6] === 'O' && contents[7] === 'O' && contents[8] === 'O')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is O";
                                return;
                            }
                            else if((contents[0] === 'O' && contents[3] === 'O' && contents[6] === 'O') || (contents[1] === 'O' && contents[4] === 'O' && contents[7] === 'O') || (contents[2] === 'O' && contents[5] === 'O' && contents[8] === 'O')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is O";
                                return;
                            }
                            else if((contents[2] === 'X' && contents[4] === 'O' && contents[6] === 'O') || (contents[0] === 'O' && contents[4] === 'O' && contents[8] === 'O')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is O";
                                return;
                            }
                            else if (contents_string.includes('-')){
                                winner = document.getElementById("winner");
                                winner.innerHTML = "There is no winner yet."; 
                                return; 
                            }
                            else {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "Stalemate."; 
                                return; 
                            }
                        })

                        clear = document.getElementById("start");
                        clear.addEventListener("click", function(){
                            sq_clear = document.getElementById("sq" + j);
                            turn = document.getElementById("turn");
                            result = document.getElementById("result");
                            turn.innerHTML = "";
                            result.innerHTML = "";
                            sq_clear.innerHTML = "";
                        })
                    }  
                }
                else {
                    for (let j = 0; j < 9; j++) {
                        sq_click = document.getElementById("sq" +j);
                        sq_click.addEventListener("click", function(){
                            result = document.getElementById("result");
                            turn = document.getElementById("turn");
						    theID = this.id;
						    number = theID.substring(2); 
						    result.innerHTML = "There is now a mark in square " + number;
                            let mark = spatt[j];
                            turn.innerHTML = "It is " + mark + " turn";
                            this.innerHTML = mark;
                            contents= divs.map(id=>document.getElementById(id).innerHTML);
                            contents_string = contents.join('');

                            if ((contents[0] === 'X' && contents[1] === 'X' && contents[2] === 'X') || (contents[3] === 'X' && contents[4] === 'X' && contents[5] === 'X') || (contents[6] === 'X' && contents[7] === 'X' && contents[8] === 'X')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is X";
                                return;
                            }
                            else if((contents[0] === 'X' && contents[3] === 'X' && contents[6] === 'X') || (contents[1] === 'X' && contents[4] === 'X' && contents[7] === 'X') || (contents[2] === 'X' && contents[5] === 'X' && contents[8] === 'X')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is X";
                                return;
                            }
                            else if((contents[2] === 'X' && contents[4] === 'X' && contents[6] === 'X') || (contents[0] === 'X' && contents[4] === 'X' && contents[8] === 'X')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is X";
                                return;
                            }
                            else if ((contents[0] === 'O' && contents[1] === 'O' && contents[2] === 'O') || (contents[3] === 'O' && contents[4] === 'O' && contents[5] === 'O') || (contents[6] === 'O' && contents[7] === 'O' && contents[8] === 'O')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is O";
                                return;
                            }
                            else if((contents[0] === 'O' && contents[3] === 'O' && contents[6] === 'O') || (contents[1] === 'O' && contents[4] === 'O' && contents[7] === 'O') || (contents[2] === 'O' && contents[5] === 'O' && contents[8] === 'O')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is O";
                                return;
                            }
                            else if((contents[2] === 'X' && contents[4] === 'O' && contents[6] === 'O') || (contents[0] === 'O' && contents[4] === 'O' && contents[8] === 'O')) {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "The winner is O";
                                return;
                            }
                            else if (contents_string.includes('-')){
                                winner = document.getElementById("winner");
                                winner.innerHTML = "There is no winner yet."; 
                                return; 
                            }
                            else {
                                winner = document.getElementById("winner");
                                winner.innerHTML = "Stalemate."; 
                                return; 
                            }
                        })
                        clear = document.getElementById("start");
                        clear.addEventListener("click", function(){
                            sq_clear = document.getElementById("sq" + j);
                            turn = document.getElementById("turn");
                            result = document.getElementById("result");
                            turn.innerHTML = "";
                            result.innerHTML = "";
                            sq_clear.innerHTML = "";
                        })
                    }
                }
            }              
		</script>
        </div>
		<div id="result"></div>
		<div id="winner"></div>
	</body>
</html>